# 更新日志

本文档记录了 CategoryMapManager 的所有重要更新。

## [1.0.0] - 2025-11-29

### 新增功能

- ✨ **批量删除映射**
  - 支持单个文件删除指定映射关系
  - 支持批量删除多个文件的映射关系（支持复选框多选）
  - 删除前自动创建备份
  - 删除操作记录到操作日志

- ✨ **对比视图**
  - 新增「对比显示」模式，可查看所有文件的映射关系对比
  - 自动折叠所有文件中映射关系一致的项
  - 高亮显示映射关系不一致的项，方便快速定位差异
  - 支持在对比视图中进行批量删除操作

- ✨ **排序功能**
  - 扫描结果按本地栏目 ID 数值大小自动排序（升序）
  - 排序不影响原文件内容，仅用于显示优化

- ✨ **操作日志**
  - 每次批量操作后自动生成详细的操作日志文件（`operation_YYYYMMDD-HHMMSS.log`）
  - 日志文件保存在处理文件的目录下
  - 记录操作类型、时间、备份路径、处理的映射详情等信息
  - 新增操作记录新增的本地栏目ID和国网栏目ID
  - 删除操作记录删除的本地栏目ID和国网栏目ID

- ✨ **备份功能增强**
  - 所有文件修改操作（新增、删除、导入）前都会自动创建备份
  - 单个删除操作也会创建备份
  - 备份路径可在操作结果中查看，支持一键打开备份文件夹

- ✨ **界面优化**
  - 优化操作指南弹窗宽度（从 420px 增加到 560px），提升阅读体验
  - 更新操作指南内容，包含所有新功能说明
  - 优化复选框显示和交互体验

### 改进

- 🔧 修复了复选框选择和全选功能的响应式问题
- 🔧 优化了折叠/展开功能的交互体验
- 🔧 改进了备份目录打开功能，使用系统默认文件管理器（Windows explorer / macOS open / Linux xdg-open）
- 🔧 优化了日志记录的详细程度和可读性
- 🔧 修复了 Vue 响应式系统与 Set 对象交互的问题

### 技术改进

- 添加了 `open_folder` Tauri 命令，用于打开本地文件夹
- 添加了 `batch_delete_mappings` Tauri 命令，支持批量删除
- 优化了 Rust 代码的错误处理
- 改进了前端状态管理，修复了 Vue 响应式相关问题
- 优化了 JSON5 格式处理，确保删除后格式正确

### 文档更新

- 更新了 README.md，添加所有新功能说明
- 创建了 CHANGELOG.md 版本更新记录
- 更新了软件内操作指南

---

## [0.1.0] - 2025-11-28

### 初始版本

- ✨ **核心功能**
  - 自动扫描识别 theme*.json 文件中的映射关系
  - 批量新增映射关系
  - 导出/导入映射配置
  - 自动备份功能（批量新增和导入时）
  - 重复检测和状态提示

- 🎨 **界面设计**
  - 现代化扁平设计风格
  - 响应式布局
  - 操作指南弹窗

- 📦 **构建和发布**
  - GitHub Actions 自动构建工作流
  - 支持 MSI 和 NSIS 安装包生成
  - 自动发布到 GitHub Releases
  - 支持便携版（.exe）和安装包（.msi, .exe）

- 🔧 **技术实现**
  - 基于 Tauri 1.6 + Vue 3 + TypeScript
  - 支持 JSON5 格式（带注释的 JSON）
  - 精确的文本解析和插入，保留原有格式和注释
